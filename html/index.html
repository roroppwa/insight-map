<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>로로뽜 인사이트 대시보드</title>
<style>
:root{
  --bg:#f8fafc;
  --card:#ffffff;
  --border:#e5e7eb;
  --muted:#64748b;
  --muted2:#94a3b8;
  --up:#b91c1c;
  --up-bg:#fee2e2;
  --down:#1d4ed8;
  --down-bg:#dbeafe;
  --accent:#ef4444;
}
/* 전역 */
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background:var(--bg);
  color:#0f172a;
}

/* 상단 헤더 + 네비게이션 */
.site-header{
  background:#ffffff;
  border-bottom:1px solid var(--border);
  box-shadow:0 2px 4px rgba(15,23,42,0.04);
}
.site-header-inner{
  max-width:1200px;
  margin:0 auto;
  padding:10px 16px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.brand{
  display:flex;
  flex-direction:column;
  gap:2px;
}
.brand-title{
  margin:0;
  font-size:18px;
  font-weight:800;
  letter-spacing:-0.02em;
}
.brand-sub{
  margin:0;
  font-size:12px;
  color:var(--muted2);
}
.nav-links{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
}
.nav-links a{
  padding:6px 10px;
  font-size:13px;
  border-radius:999px;
  border:1px solid transparent;
  text-decoration:none;
  color:#4b5563;
  background:transparent;
}
.nav-links a.active{
  background:var(--accent);
  color:#ffffff;
  border-color:var(--accent);
}
.nav-links a:hover:not(.active){
  background:#e5e7eb;
}

/* 레이아웃 래퍼 */
.wrap{
  max-width:1200px;
  margin:0 auto;
  padding:16px;
}

/* 안내 상자 */
.notice{
  margin:0 0 12px 0;
  padding:12px 14px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#fefce8;
  font-size:13px;
  color:#374151;
}
.notice b{
  font-weight:700;
}

/* 메인 카드 (장전/장후 iframe 담는 카드) */
.main-card{
  background:var(--card);
  border-radius:14px;
  border:1px solid var(--border);
  box-shadow:0 2px 8px rgba(15,23,42,0.04);
  padding:14px 14px 10px 14px;
}

/* 장전/장후 탭 버튼 */
.sub-tabs{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
  margin-bottom:8px;
}
.sub-tab-buttons{
  display:flex;
  gap:6px;
}
.sub-tab{
  padding:7px 14px;
  border-radius:999px;
  border:1px solid transparent;
  font-size:13px;
  background:#f3f4f6;
  color:#4b5563;
  cursor:pointer;
}
.sub-tab.active{
  background:#fee2e2;
  color:#b91c1c;
  border-color:#fecaca;
  font-weight:600;
}
.sub-tab:hover{
  background:#e5e7eb;
}
.session-label{
  font-size:12px;
  color:var(--muted);
}

/* iframe 영역 */
.frame-wrap{
  border-radius:10px;
  overflow:hidden;
  border:1px solid var(--border);
  margin-top:6px;
}
#dashboard-frame{
  width:100%;
  height:calc(100vh - 210px);
  border:none;
  display:block;
  background:var(--card);
}

/* 반응형 */
@media (max-width:768px){
  .site-header-inner{
    flex-direction:column;
    align-items:flex-start;
  }
  #dashboard-frame{
    height:calc(100vh - 230px);
  }
}
</style>
</head>
<body>

<header class="site-header">
  <div class="site-header-inner">
    <div class="brand">
      <h1 class="brand-title">로로뽜 인사이트</h1>
      <p class="brand-sub">장전·장후 테마 스캔 대시보드</p>
    </div>
    <nav class="nav-links">
      <a href="index.html" class="active">대시보드</a>
    </nav>
  </div>
</header>

<div class="wrap">
  <p class="notice">
    <b>장전/장후 테마 대시보드</b><br>
    전일 기준으로 주요 테마·종목의 모멘텀과 수급을 스캔한 결과입니다.
    상단 탭에서 <b>장전</b> / <b>장후</b> 화면을 선택할 수 있으며,
    기본으로는 현재 시각 기준으로 더 적절한 화면을 자동으로 띄웁니다.
    (<span id="time-info"></span> 기준)
  </p>

  <div class="main-card">
    <div class="sub-tabs">
      <div class="sub-tab-buttons">
        <button class="sub-tab" id="tab-preopen" data-target="preopen">장전 대시보드</button>
        <button class="sub-tab" id="tab-postclose" data-target="postclose">장후 대시보드</button>
      </div>
      <div class="session-label" id="session-info"></div>
    </div>

    <div class="frame-wrap">
      <iframe id="dashboard-frame" src=""></iframe>
    </div>
  </div>
</div>

<script>
  function detectSession() {
    const now = new Date();
    const hour = now.getHours();
    // 09시 전에 접속하면 장전, 그 이후는 장후 기준
    if (hour < 9) return "preopen";
    return "postclose";
  }

  function formatNow() {
    const now = new Date();
    const y = now.getFullYear();
    const m = String(now.getMonth() + 1).padStart(2, "0");
    const d = String(now.getDate()).padStart(2, "0");
    const hh = String(now.getHours()).padStart(2, "0");
    const mm = String(now.getMinutes()).padStart(2, "0");
    return `${y}-${m}-${d} ${hh}:${mm}`;
  }

  function setSessionText(session) {
    const el = document.getElementById("session-info");
    if (!el) return;
    if (session === "preopen") {
      el.textContent = "지금은 장전(시가 전) 기준 화면을 보고 있습니다.";
    } else {
      el.textContent = "지금은 장후(종가 기준) 화면을 보고 있습니다.";
    }
  }

  function setActiveTab(target) {
    const frame = document.getElementById("dashboard-frame");
    const tabPre = document.getElementById("tab-preopen");
    const tabPost = document.getElementById("tab-postclose");

    tabPre.classList.remove("active");
    tabPost.classList.remove("active");

    if (target === "preopen") {
      tabPre.classList.add("active");
      frame.src = "preopen/preopen.html";
    } else {
      tabPost.classList.add("active");
      frame.src = "postclose/postclose.html";
    }
    setSessionText(target);
  }

  function initTabs() {
    document.getElementById("tab-preopen")
      .addEventListener("click", () => setActiveTab("preopen"));
    document.getElementById("tab-postclose")
      .addEventListener("click", () => setActiveTab("postclose"));
  }

  function init() {
    const timeInfo = document.getElementById("time-info");
    if (timeInfo) {
      timeInfo.textContent = formatNow() + " (로컬 PC 기준)";
    }

    initTabs();

    const params = new URLSearchParams(window.location.search);
    const qTab = params.get("tab");
    const session = (qTab === "preopen" || qTab === "postclose")
      ? qTab
      : detectSession();

    setActiveTab(session);
  }

  window.addEventListener("DOMContentLoaded", init);
</script>

</body>
</html>
